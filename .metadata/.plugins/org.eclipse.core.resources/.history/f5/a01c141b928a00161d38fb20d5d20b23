package br.edu.unoesc;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Scanner;
import java.util.Set;
import java.util.TreeSet;
import java.util.stream.Collectors;

public class Exer03 {

	static double total = 0;
	static double money = 100000;

	public static void menu() {

		System.out.println("\n\n     Supermercado:\n");
		System.out.println("1 - Comprar");
		System.out.println("2 - Verificar se item já está na lista");
		System.out.println("3 - Listar produtos normal");
		System.out.println("4 - Listar produtos lambda");
		System.out.println("5 - Produtos Sadia em sua lista");
		System.out.println("6 - Tenho apenas 50 reais");
		System.out.println("0 - Sair");
	}

	public static void main(String[] args) {
		Scanner teclado = new Scanner(System.in);
		int opcao;
		Set<String> produtos = new TreeSet<>();
		Map<String, Integer> estoque = new HashMap<>();
		List<String> compras = new ArrayList<>();
		Map<String, Double> precos = new HashMap<>();

		produtos.add("CarneSadia");
		produtos.add("CarneFriboi");
		produtos.add("Arroz");
		produtos.add("Feijão");
		estoque.put("CarneSadia", 10);
		estoque.put("CarneFriboi", 10);
		estoque.put("Arroz", 10);
		estoque.put("Feijão", 10);
		precos.put("CarneSadia", 20.00);
		precos.put("CarneFriboi", 18.50);
		precos.put("Arroz", 5.20);
		precos.put("Feijão", 7.10);

		while (true) {
			menu();
			opcao = teclado.nextInt();
			if (opcao == 1) {
				comprar(teclado, produtos, estoque, compras, precos);
			} else if (opcao == 2) {
				verificar(teclado, produtos, compras);
			} else if (opcao == 3) {
				listarnormal(produtos);
			} else if (opcao == 4) {
				listarlambda(produtos);
			} else if (opcao == 5) {
				Sadia(produtos, compras);
			} else if (opcao == 6) {
				money = 50;
			} else
				break;
		}
		teclado.close();
	}

	private static int sotem50(List<String> compras, Map<String, Integer> estoque, Map<String, Double> precos,
			String prod) {
		int b = 0;
		if (total > 50 && money == 50) {
			b = 1;
		}
		return b;
	}

	private static void removeritem(List<String> compras, Map<String, Integer> estoque, Map<String, Double> precos,
			String prod) {
		int a = 0;
		double dinheiro = 50;
		if (dinheiro > 50) {
			a = estoque.get(prod);
			estoque.put(prod, (a - 1));
		} else {
			int b = sotem50(compras, estoque, precos, prod);
			if (b == 1) {
				System.out.println("Voce nao tem mais dinheiro suficiente");
			} else {
				a = estoque.get(prod);
				estoque.put(prod, (a - 1));
			}
		}
	}

	private static void comprar(Scanner teclado, Set<String> produtos, Map<String, Integer> estoque,
			List<String> compras, Map<String, Double> precos) {
		System.out.println("Digite o nome do produto que deseja adicionar ao carrinho");
		String prod = Teclado.lerString();
		total += precos.get(prod);
		compras.add(prod);
		removeritem(compras, estoque, precos, prod);
	}

	private static void verificar(Scanner teclado, Set<String> produtos, List<String> compras) {
		System.out.println("Digite o nome do produto no qual quer verificar");
		String prod = Teclado.lerString();
		if (compras.contains(prod)) {
			System.out.println("Seu produto ja está no carrinho");
		} else
			System.out.println("Seu produto ainda não está no carrinho");
	}

	private static void listarlambda(Set<String> produtos) {
		produtos.forEach(p -> System.out.println(p));
	}

	private static void listarnormal(Set<String> produtos) {
		for (String p : produtos) {
			System.out.println(p);
		}
	}

	private static void Sadia(Set<String> produtos, List<String> compras) {
		Set<String> Sadia = compras.stream().filter(p -> p.contains("Sadia")).collect(Collectors.toSet());
		System.out.println(Sadia);
	}
}
